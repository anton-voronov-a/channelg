<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8" />
  <title>oauth2</title>
</head>
<body>
  <h1 id="text"></h1>
  <script>
    (() => {

      const knownExtensionIds = [
        'abcinaijmbdjepphjkbinogpjdiagedp', /*Edge Add-ons*/
        'hopcbmeplpekjenhhkiceeeaeoeoaona', /*Chrome Web Store*/
        'nbdgkkjgjbpehihabnbbecclcjlgdhfd', /*Opera add-ons*/
        '{2DC4269B-9DB2-4E1C-80C9-62D7B961D63C}', /*firefox*/
        'edollpipofgkdhgioonhnblenpcahbnc' /*local Chrome*/
      ];

      const hash = location.hash;
      if (location.hash.length) {
        const params = new URLSearchParams(hash.substring(1));
        const extensionId = params.get("state");

        if (knownExtensionIds.indexOf(extensionId) > -1) {
          const redirectUrl = `https://${extensionId}.chromiumapp.org`;
          document.getElementById('text').innerHTML = `Redirect to ${redirectUrl}, extensionId '${extensionId}'`;
          location.href = `${redirectUrl}/${location.hash}`;
        } else {
          document.getElementById('text').innerHTML = `Can not redirect (extensionId '${extensionId}' is unknown).`;
        }

      } else {
        document.getElementById('text').innerHTML = `Can not redirect (empty hash).`;
      }

    })();
  </script>
</body>
</html>
